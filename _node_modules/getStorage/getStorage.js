module.exports = function(RED) {
    function getStorage(config) {

        RED.nodes.createNode(this,config);
        this.prefix = config.prefix;
        var node = this;
        
        var fileName = this.prefix;
        
        var fs = require('fs');
        
        var storage = [];
        
		node.on('input', function(msg) {

			if (msg.payload == true) {
			
				fs.readFile(fileName + '.json', 'utf8', function (err, data) {
					if (!err) {
						msg.payload = JSON.parse(data);
						node.send(msg);
					}
				});
			}
		});
		
		node.on('close', function() {
		});
    }
    RED.nodes.registerType("getStorage",getStorage);
}