module.exports = function(RED) {
    function processData(config) {
        RED.nodes.createNode(this,config);
        var node = this;
        
        /*
        node.on('input', function(msg) {
            
            msg2 = RED.util.cloneMessage(msg);
            msg2.payload = false;
            
			var fs = require('fs');
			var R = require("r-script");

			fs.readFile('moodle.json', 'utf8', function (err, datain) {
				if (!err) {
    					
    				R("test.r")
						.data(JSON.parse(datain))
						.call(function(err, dataout) {
							if (!err) {
							
								fs.writeFile("moodle2.json", JSON.stringify(dataout), function(err) {
    								if(!err) {
										
										msg.payload = dataout;
										msg2.payload = true;
										node.send([msg,msg2]);
									}
								});
							}
						});
				}
			});            
        });
        
        */
    }
    RED.nodes.registerType("processingService",processData);
}