module.exports = function(RED) {
    function objToTab(config) {

        RED.nodes.createNode(this,config);
     	this.source = config.source;
		this.path = config.path;
     	this.descr = config.descr;
     	this.typeoutput = config.typeoutput;
        var node = this;
		
		node.on('input', function(msg) {
  			
  			if (node.typeoutput == "chart") {
  				msg.payload = { "url": "/" + node.source + node.path, "source": node.source, "description": node.descr, "chart": { "data": msg.payload, "chartOptions": [{"selected": 1, "label": "access", "type": "bar", "icon": "stats"}]}};
  			}
  			else if (node.typeoutput == "table") {
  				msg.payload = { "url": "/" + node.source + node.path, "source": node.source, "description": node.descr, "details": { "data": msg.payload } };
  			}
  			
  			msg.topic = "/" + node.source + node.path;
  			node.send(msg);
		});
		
		node.on('close', function() {
		});
    }
    RED.nodes.registerType("obj-to-tab",objToTab);
}